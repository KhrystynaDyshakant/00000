{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}–ó–≤—ñ—Ç–∏ —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞{% endblock %}

{% block content %}
<h1>üìä –ó–≤—ñ—Ç–∏ —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞</h1>

<!-- –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0;">
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center;">
        <h2 style="margin: 0; font-size: 2.5em;">{{ total_employees }}</h2>
        <p style="margin: 5px 0 0 0;">–°–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤</p>
    </div>
    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 10px; text-align: center;">
        <h2 style="margin: 0; font-size: 2.5em;">{{ pending_requests }}</h2>
        <p style="margin: 5px 0 0 0;">–ó–∞—è–≤–æ–∫ –Ω–∞ —Ä–æ–∑–≥–ª—è–¥</p>
    </div>
    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 10px; text-align: center;">
        <h2 style="margin: 0; font-size: 2.5em;">{{ on_work_now }}</h2>
        <p style="margin: 5px 0 0 0;">–ó–∞—Ä–∞–∑ –Ω–∞ —Ä–æ–±–æ—Ç—ñ</p>
    </div>
    <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 10px; text-align: center;">
        <h2 style="margin: 0; font-size: 2.5em;">{{ on_leave_now }}</h2>
        <p style="margin: 5px 0 0 0;">–£ –≤—ñ–¥–ø—É—Å—Ç—Ü—ñ</p>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
    <!-- –ó–≤—ñ—Ç –ø–æ –≤—ñ–¥–¥—ñ–ª–∞—Ö —Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç–∞—Ö -->
    <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h2 style="color: #417690; margin-top: 0;">üí∞ –í–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –∑–∞—Ä–ø–ª–∞—Ç–∏ –ø–æ –≤—ñ–¥–¥—ñ–ª–∞—Ö</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead style="background: #f8f9fa;">
                <tr>
                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">–í—ñ–¥–¥—ñ–ª</th>
                    <th style="padding: 12px; text-align: center; border-bottom: 2px solid #dee2e6;">–°–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤</th>
                    <th style="padding: 12px; text-align: right; border-bottom: 2px solid #dee2e6;">–ó–∞–≥–∞–ª—å–Ω–∞ –∑–∞—Ä–ø–ª–∞—Ç–∞</th>
                    <th style="padding: 12px; text-align: right; border-bottom: 2px solid #dee2e6;">–°–µ—Ä–µ–¥–Ω—è</th>
                </tr>
            </thead>
            <tbody>
                {% for dept in salary_by_dept %}
                <tr style="border-bottom: 1px solid #dee2e6;">
                    <td style="padding: 12px;"><strong>{{ dept.department }}</strong></td>
                    <td style="padding: 12px; text-align: center;">{{ dept.count }}</td>
                    <td style="padding: 12px; text-align: right; color: #28a745; font-weight: bold;">{{ dept.total_salary|floatformat:0 }} –≥—Ä–Ω</td>
                    <td style="padding: 12px; text-align: right;">{{ dept.avg_salary|floatformat:0 }} –≥—Ä–Ω</td>
                </tr>
                {% endfor %}
                <tr style="background: #f8f9fa; font-weight: bold;">
                    <td style="padding: 12px;" colspan="2">–†–ê–ó–û–ú:</td>
                    <td style="padding: 12px; text-align: right; color: #28a745; font-size: 1.1em;">{{ total_salary|floatformat:0 }} –≥—Ä–Ω</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫ -->
    <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h2 style="color: #417690; margin-top: 0;">üìã –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                <h3 style="margin: 0; color: #1976d2; font-size: 2em;">{{ total_requests }}</h3>
                <p style="margin: 5px 0 0 0; color: #666;">–í—Å—å–æ–≥–æ –∑–∞—è–≤–æ–∫</p>
            </div>
            <div style="background: #fff3e0; padding: 15px; border-radius: 8px; text-align: center;">
                <h3 style="margin: 0; color: #f57c00; font-size: 2em;">{{ pending_requests }}</h3>
                <p style="margin: 5px 0 0 0; color: #666;">–û—á—ñ–∫—É—é—Ç—å</p>
            </div>
            <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; text-align: center;">
                <h3 style="margin: 0; color: #388e3c; font-size: 2em;">{{ approved_requests }}</h3>
                <p style="margin: 5px 0 0 0; color: #666;">–°—Ö–≤–∞–ª–µ–Ω–æ</p>
            </div>
            <div style="background: #ffebee; padding: 15px; border-radius: 8px; text-align: center;">
                <h3 style="margin: 0; color: #d32f2f; font-size: 2em;">{{ rejected_requests }}</h3>
                <p style="margin: 5px 0 0 0; color: #666;">–í—ñ–¥—Ö–∏–ª–µ–Ω–æ</p>
            </div>
        </div>

        <div style="margin-top: 20px; background: #f8f9fa; padding: 15px; border-radius: 8px;">
            <h4 style="margin-top: 0;">üìÖ –í—ñ–¥–ø—É—Å—Ç–∫–∏</h4>
            <p><strong>–¶—å–æ–≥–æ –º—ñ—Å—è—Ü—è:</strong> {{ leaves_this_month }} –∑–∞—è–≤–æ–∫</p>
            <p><strong>–ó–∞—Ä–∞–∑ —É –≤—ñ–¥–ø—É—Å—Ç—Ü—ñ:</strong> {{ on_leave_now }} —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤</p>
        </div>
    </div>
</div>

<!-- –†–æ–±–æ—á–∏–π —á–∞—Å -->
<div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-top: 20px;">
    <h2 style="color: #417690; margin-top: 0;">‚è∞ –û–±–ª—ñ–∫ —Ä–æ–±–æ—á–æ–≥–æ —á–∞—Å—É (–æ—Å—Ç–∞–Ω–Ω—ñ–π —Ç–∏–∂–¥–µ–Ω—å)</h2>
    <p><strong>–ó–∞–≥–∞–ª—å–Ω—ñ –≥–æ–¥–∏–Ω–∏:</strong> {{ total_hours_week }} –≥–æ–¥</p>
    <p><strong>–ó–∞—Ä–∞–∑ –Ω–∞ —Ä–æ–±–æ—Ç—ñ:</strong> {{ on_work_now }} —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤</p>

    <h4>–¢–æ–ø-10 —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –ø–æ –≤—ñ–¥–ø—Ä–∞—Ü—å–æ–≤–∞–Ω–∏—Ö –≥–æ–¥–∏–Ω–∞—Ö:</h4>
    <table style="width: 100%; border-collapse: collapse;">
        <thead style="background: #f8f9fa;">
            <tr>
                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">#</th>
                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">–°–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫</th>
                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">–í—ñ–¥–¥—ñ–ª</th>
                <th style="padding: 10px; text-align: right; border-bottom: 2px solid #dee2e6;">–ì–æ–¥–∏–Ω</th>
            </tr>
        </thead>
        <tbody>
            {% for item in top_workers %}
            <tr style="border-bottom: 1px solid #dee2e6;">
                <td style="padding: 10px;">{{ forloop.counter }}</td>
                <td style="padding: 10px;"><strong>{{ item.employee.first_name }} {{ item.employee.last_name }}</strong></td>
                <td style="padding: 10px;">{{ item.employee.department }}</td>
                <td style="padding: 10px; text-align: right; color: #17a2b8; font-weight: bold;">{{ item.hours|floatformat:1 }} –≥–æ–¥</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- –í–∞–∫–∞–Ω—Å—ñ—ó —Ç–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–∏ -->
<div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-top: 20px;">
    <h2 style="color: #417690; margin-top: 0;">üéØ –†–µ–∫—Ä—É—Ç–∏–Ω–≥</h2>
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
        <div style="background: #e1f5fe; padding: 15px; border-radius: 8px; text-align: center;">
            <h3 style="margin: 0; color: #0277bd;">{{ active_vacancies }}</h3>
            <p style="margin: 5px 0 0 0;">–ê–∫—Ç–∏–≤–Ω–∏—Ö –≤–∞–∫–∞–Ω—Å—ñ–π</p>
        </div>
        <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; text-align: center;">
            <h3 style="margin: 0; color: #7b1fa2;">{{ total_candidates }}</h3>
            <p style="margin: 5px 0 0 0;">–í—Å—å–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç—ñ–≤</p>
        </div>
        <div style="background: #fff9c4; padding: 15px; border-radius: 8px; text-align: center;">
            <h3 style="margin: 0; color: #f57f17;">{{ new_candidates }}</h3>
            <p style="margin: 5px 0 0 0;">–ù–æ–≤–∏—Ö —Ä–µ–∑—é–º–µ</p>
        </div>
    </div>
</div>

<p style="margin-top: 30px;">
    <a href="{% url 'admin:index' %}" class="button">‚Üê –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ –≥–æ–ª–æ–≤–Ω–æ—ó</a>
</p>
{% endblock %}